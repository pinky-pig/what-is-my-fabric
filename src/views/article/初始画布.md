# 初始 canvas 画布

这里将 canvas 有关的变量，统一放在 Pinia 中管理了，比如dom元素，及一些系统状态属性
但是 fabric 渲染的 canvas 没有放入store，在 useCanvas 中

因为放入store中，在使用 canvas 的时候，从 store 中获取，就需要先关注一下执行顺序，增加心智负担
在这里就在 useCanvas 中，使用的时候导出

```ts
export const useFabricStore = defineStore({
  id: 'fabricStore',
  state: (): IDesignState => {
    return {
      wrapperRef: null,
      canvasRef: null,
      canvas: null,
      mode: 'Hand',
      modeList: Object.keys(Mode) as TMode[],
      pointer: { x: 0, y: 0 },
      ismousedown: false,
      isCanvasDragging: false,
      isCtrlKey: false,
      zoom: 1,
      activeObjectId: null,
    }
  },
})
```
1. 初始化

```ts
fabricStore.canvas = new fabric.Canvas(fabricStore.canvasRef, {
  width: 800,
  height: 600,
  preserveObjectStacking: true,
})
```
2. 监听dom的尺寸，设置canvas的尺寸

```ts
const setViewport = (width, height) => {
  const fabricStore = useFabricStore()
  if (fabricStore.canvas) {
    fabricStore.canvas.setWidth(width)
    fabricStore.canvas.setHeight(height)
    fabricStore.canvas.renderAll()
  }
}
```

